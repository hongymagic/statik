#!/usr/bin/env node

var usage = [
'HTTP all the things!',
'',
'Usage:',
'  statik [options] [directory]',
'  statik --help',
'',
'Options:',
'  --help        Show this screen.',
'  --port        Bind to a specific port. Defaults to 3000.',
'  --compress    Enable gzip compression. Defaults to true.',
'  --hidden      Allow hidden files to be served. Defaults to false.',
'  --redirect    Redirect to trailing "/" when pathname is directory. Defaults to true.',
'  --maxAge      Browser cache maxAge in milliseconds. Defaults to 0.',
'  --auth        Enable http-authentication. Defaults to false.',
'  --authRealm   Window title for http-authentication. Defaults to "Restricted realm".',
'  --authFile    Path to file with passwords. Defaults to "/../data/users.htpasswd".',
'  --verbose     Enable verbose logging to stdout. Defaults to false.'
].join('\n');

var nopt = require('nopt');
var path = require('path');
var known = {
	"port": Number,
	"maxAge": Boolean,
	"hidden": Boolean,
	"redirect": Boolean,
	"compress": Boolean,
  "auth": Boolean,
  "authRealm": String,
  "authFile": String,
	"verbose": Boolean,
	"help": Boolean
};
var options = nopt(known);

if (options.help)
	return console.log(usage);

if (options.argv.remain[0] !== undefined)
	options.root = path.resolve(options.argv.remain[0]);

var statik = require('../index');
var server = statik(options);
